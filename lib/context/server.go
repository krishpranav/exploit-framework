package context

import (
	"bytes"
	"crypto/rand"
	"crypto/tls"
	"encoding/json"
	"fmt"
	"net"
	"os"
	"strings"
	"time"


	"github.com/krishpranav/exploit-framework/lib/util/crypto"
	"github.com/krishpranav/exploit-framework/lib/util/hash"
	"github.com/krishpranav/exploit-framework/lib/util/log"
	"github.com/krishpranav/exploit-framework/lib/util/message"
	"github.com/krishpranav/exploit-framework/lib/util/network"
	"github.com/krishpranav/exploit-framework/lib/util/raas"
	"github.com/krishpranav/exploit-framework/lib/util/str"

	humanize "github.com/dustin/go-humanize"
	"github.com/jedib0t/go-pretty/table"
)

type WebSocketMessage struct {
	Type WebSocketMessageType
	Data interface{}
}

type TCPServer struct {
	Host           string                      `json:"host"`
	GroupDispatch  bool                        `json:"group_dispatch"`
	Port           uint16                      `json:"port"`
	Clients        map[string](*TCPClient)     `json:"clients"`
	TermiteClients map[string](*TermiteClient) `json:"termite_clients"`
	TimeStamp      time.Time                   `json:"timestamp"`
	Interfaces     []string                    `json:"interfaces"`
	Hash           string                      `json:"hash"`
	Encrypted      bool                        `json:"encrypted"`
	hashFormat     string
	stopped        chan struct{}
}
