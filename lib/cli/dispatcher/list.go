package dispatcher

import (
	"fmt"

	"github.com/krishpranav/exploit-framework/lib/context"
	"github.com/krishpranav/exploit-framework/lib/util/log"
)

// list how many servers are there
func (dispatcher Dispatcher) List(args []string) {
	if len(context.Ctx.Servers) == 0 {
		log.Warn(fmt.Sprintf("No listening servers"))
		return
	}
	log.Info(fmt.Sprintf("Listing %d listening servers", len(context.Ctx.Servers)))

	for _, server := range context.Ctx.Servers {
		server.AsTable()
	}
}

// list server help function
func (dispatcher Dispatcher) ListHelp(args []string) {
	fmt.Println("Usage of List")
	fmt.Println("\tList")
}

// list description function
func (dispatcher Dispatcher) ListDesc(args []string) {
	fmt.Println("List")
	fmt.Println("\tTry list all listening servers and connected clients")
}
